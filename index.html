<!DOCTYPE html>
<html>

<head>
    <title>Guitar Chord Guesser</title>
    <style>
        #settings-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);
            padding: 20px;
            z-index: 999;
            display: none;
        }
    </style>
</head>

<body>
    <div id="images-container">
        <img id="random-chord" src="" alt="Random Chord" />
        <p id="chord-name"></p>
        <button id="settings-button">Settings</button>
        <div id="settings-container" style="display:none;">
            <label for="only-img-time">Only Image Time (in seconds):</label>
            <input type="number" id="only-img-time" value="7" min="1"><br>
            <label for="text-time">Text Time (in seconds):</label>
            <input type="number" id="text-time" value="3" min="1"><br>
            <label for="gap-time">Gap Time (in seconds):</label>
            <input type="number" id="gap-time" value="3" min="1"><br>
            <label for="note-select">Note:</label>
            <select id="note-select">
                <option value="FREE">FREE</option>
                <option value="A">A</option>
                <option value="A#">A#</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="C#">C#</option>
                <option value="D">D</option>
                <option value="D#">D#</option>
                <option value="E">E</option>
                <option value="F">F</option>
                <option value="F#">F#</option>
                <option value="G">G</option>
                <option value="G#">G#</option>
            </select><br>
            <button id="update-button">Update</button>
            <button id="default-button">Default</button>
            <button id="cancel-button">Cancel</button>
        </div>

    </div>

    <script>
        // Define arrays of chords images and names
        const images = {
            a: [
                "https://cdn.pixabay.com/photo/2023/02/14/18/55/flowers-7790227_640.jpg",
                "https://cdn.pixabay.com/photo/2023/01/31/05/59/zebra-7757193_640.jpg",
            ],
            b: [
                "https://cdn.pixabay.com/photo/2023/01/05/22/35/flower-7700011_640.jpg",
                "https://cdn.pixabay.com/photo/2023/01/23/09/26/cat-7738210__340.jpg",
                "https://cdn.pixabay.com/photo/2023/01/27/06/17/pheasant-7747830__340.jpg",
            ]
        };
        const names = {
            a: [
                "Chord A",
                "Chord B",
            ],
            b: [
                "Chord C",
                "Chord D",
                "Chord E",
            ]
        };

        // Get HTML elements
        const settingsButton = document.getElementById('settings-button');
        const settingsContainer = document.getElementById('settings-container');
        const updateButton = document.getElementById('update-button');
        const cancelButton = document.getElementById('cancel-button');
        const defaultButton = document.getElementById('default-button');
        const onlyImgTimeInput = document.getElementById('only-img-time');
        const textTimeInput = document.getElementById('text-time');
        const gapTimeInput = document.getElementById('gap-time');
        const noteInput = document.getElementById('note-select');

        // Load values from local storage
        let onlyImgTime = parseInt(localStorage.getItem('onlyImgTime')) || 7;
        let textTime = parseInt(localStorage.getItem('textTime')) || 3;
        let gapTime = parseInt(localStorage.getItem('gapTime')) || 0;
        let note = localStorage.getItem('note');
        if (note) {
            note = note.toLowerCase().replace(/#/g, 'sharp');
        } else {
            note = 'free';
        }

        // Update input values
        onlyImgTimeInput.value = onlyImgTime;
        textTimeInput.value = textTime;
        gapTimeInput.value = gapTime;
        noteInput.value = note.replace(/sharp/g, '#').toUpperCase();

        // Show/hide settings container
        settingsButton.addEventListener('click', () => {
            settingsContainer.style.display = (settingsContainer.style.display === 'none') ? 'block' : 'none';
        });

        // Handle update button click event
        updateButton.addEventListener('click', () => {
            // Check if input values are valid
            if (onlyImgTimeInput.value < 1 || textTimeInput.value < 1 || gapTimeInput.value < 0) {
                alert("Please enter values greater than or equal to 1");
                return;
            }
            // Update variable values and store in local storage
            onlyImgTime = parseInt(onlyImgTimeInput.value);
            textTime = parseInt(textTimeInput.value);
            gapTime = parseInt(gapTimeInput.value);
            note = noteInput.value.toLowerCase().replace(/#/g, 'sharp');
            localStorage.setItem('onlyImgTime', onlyImgTime);
            localStorage.setItem('textTime', textTime);
            localStorage.setItem('gapTime', gapTime);
            localStorage.setItem('note', note);
            location.reload();
        });

        // Add an event listener to the "Default" button
        defaultButton.addEventListener('click', () => {
            // Set the default values for the variables
            onlyImgTime = 7;
            textTime = 3;
            gapTime = 0;
            note = 'FREE';

            // Store the default values in local storage
            localStorage.setItem('onlyImgTime', onlyImgTime);
            localStorage.setItem('textTime', textTime);
            localStorage.setItem('gapTime', gapTime);
            localStorage.setItem('note', note);

            // Update the input values
            onlyImgTimeInput.value = onlyImgTime;
            textTimeInput.value = textTime;
            gapTimeInput.value = gapTime;
            noteInput.value = note;
            location.reload();
        });

        // Handle cancel button click event
        cancelButton.addEventListener('click', () => {
            settingsContainer.style.display = 'none';
        });

        // Get references to the image and name elements
        const imageElement = document.getElementById("random-chord");
        const nameElement = document.getElementById("chord-name");

        // Display a random image and name pair
        function displayRandomImage() {
            const randomIndex = Math.floor(Math.random() * images[note].length);
            imageElement.src = images[note][randomIndex];

            // Show the image alone
            imageElement.style.display = "block";
            setTimeout(() => {
                // Show the name with the image still displaying
                nameElement.style.display = "block";
                nameElement.textContent = names[note][randomIndex];

                // Hide the name and image to repeat
                setTimeout(() => {
                    nameElement.style.display = "none";
                    imageElement.style.display = "none";

                    // Display the new set after hiding the previous one
                    setTimeout(() => {
                        displayRandomImage();
                    }, gapTime * 1000);
                }, textTime * 1000);
            }, onlyImgTime * 1000);
        }

        // Display the first image and hide the name initially
        displayRandomImage();
        nameElement.style.display = "none";
    </script>
</body>

</html>
