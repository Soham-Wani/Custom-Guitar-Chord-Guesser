<!DOCTYPE html>
<html>

<head>
    <title>Guitar Chord Guesser</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        @import url("https://fonts.googleapis.com/css?family=Montserrat");

        :root {
            --main-color: #000000;
        }

        body {
            background: var(--main-color);
            font-family: "Montserrat", sans-serif;
        }

        @media screen and (max-width: 768px) {
            #random-chord {
                width: 80vw !important;
                left: 10% !important;
            }

            #settings-container {
                left: 0 !important;
                right: 0 !important;
                width: auto !important;
                transform: none !important;
            }
        }

        #images-container {
            margin: 0;
            background: var(--main-color);
            border-radius: 12px;
            position: absolute;
            top: 50%;
            left: 50%;
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
        }

        #random-chord {
            border-radius: 12px;
            max-height: 75vh;
            width: 50vw;
            left: 25%;
        }

        #chord-name {
            text-align: center;
            font-size: 4vh;
            color: #000000;
            background: #DDDDDD;
            border-radius: 0 0 12px 12px;
            padding: 10px;
            font-weight: 900;
        }

        #settings-button {
            border: none;
            padding: 10px;
            border-radius: 50%;
            background: #000000;
            color: #DDDDDD;
            text-align: center;
            height: 50px;
            width: 50px;
            font-size: 30px;
            cursor: pointer;
            position: fixed;
            bottom: 20px;
            right: 20px;
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 1);
        }

        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            transition: opacity 0.7s ease-in-out;
            pointer-events: none;
        }

        #overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        #settings-container {
            position: fixed;
            width: 33%;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 12px 12px 0 0;
            background-color: #DDDDDD;
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 999;
            bottom: -100%;
            transition: bottom 0.7s ease-in-out;
            padding: 0 20px 30px 20px;
            line-height: 20px;
        }

        #settings-container.show {
            bottom: 0;
        }

        #cancel-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: solid 1px;
            cursor: pointer;
            font-size: 20px;
            border-radius: 50%;
        }

        #settings-container h2 {
            text-align: center;
            font-weight: 900;
        }

        #settings-container label {
            padding-top: 25px;
        }

        #settings-container input {
            border: 1px solid;
            border-radius: 5px;
            width: 100%;
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            background: transparent;
            padding: 2px;
        }

        #settings-container select {
            border-radius: 5px;
            border: 1px solid;
            font-family: inherit;
            font-size: inherit;
            cursor: pointer;
            width: 101%;
            line-height: inherit;
            background: transparent;
            padding: 2px;
        }

        #color-picker {
            width: 101% !important;
            cursor: pointer;
        }

        #settings-buttons {
            text-align: center;
        }

        #settings-buttons button {
            font-family: inherit;
            font-size: inherit;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            padding: 10px;
            background-color: #000000;
            color: #DDDDDD;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div id="images-container">
        <img id="random-chord" src="" alt="Random Chord" />
        <div id="chord-name"></div>
    </div>
    <button id="settings-button"><i class="fa fa-cog" aria-hidden="true"></i></button>
    <div id="overlay"></div>
    <div id="settings-container">
        <h2>Settings</h2>
        <button id="cancel-button"><i class="fa fa-times" aria-hidden="true"></i></button>
        <label for="only-img-time">Chord diagram display time (in seconds):</label>
        <input type="number" id="only-img-time" value="7" min="1"><br><br>
        <label for="text-time">Chord name display time (in seconds):</label>
        <input type="number" id="text-time" value="3" min="1"><br><br>
        <label for="gap-time">Gap between 2 sets (in seconds):</label>
        <input type="number" id="gap-time" value="3" min="0"><br><br>
        <label for="note-select">Game-type: </label>
        <select id="note-select">
            <option value="A">A</option>
            <option value="A#">A#</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="C#">C#</option>
            <option value="D">D</option>
            <option value="D#">D#</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="F#">F#</option>
            <option value="G">G</option>
            <option value="G#">G#</option>
            <option value="FREE">FREE</option>
        </select><br><br>
        <label for="color-picker">Choose background color:</label>
        <input type="color" id="color-picker" name="color-picker" value="#000000" list="preset-colors"><br><br>
        <div id="settings-buttons">
            <button id="update-button">Update</button>
            <button id="default-button">Reset</button>
        </div>

    </div>

    <script>
        // Define arrays of chords images and names
        const images = {
            a: [
                "https://cdn.pixabay.com/photo/2023/02/14/18/55/flowers-7790227_640.jpg",
                "https://cdn.pixabay.com/photo/2023/01/31/05/59/zebra-7757193_640.jpg",
            ],
            b: [
                "https://cdn.pixabay.com/photo/2023/01/05/22/35/flower-7700011_640.jpg",
                "https://cdn.pixabay.com/photo/2023/01/23/09/26/cat-7738210__340.jpg",
                "https://cdn.pixabay.com/photo/2023/01/27/06/17/pheasant-7747830__340.jpg",
            ]
        };
        const names = {
            a: [
                "Chord A",
                "Chord B",
            ],
            b: [
                "hi",
                "B Major",
                "B Minor 3fr",
            ]
        };

        // Get HTML elements
        const imageElement = document.getElementById("random-chord");
        const nameElement = document.getElementById("chord-name");
        const settingsButton = document.getElementById('settings-button');
        const settingsContainer = document.getElementById('settings-container');
        const updateButton = document.getElementById('update-button');
        const cancelButton = document.getElementById('cancel-button');
        const defaultButton = document.getElementById('default-button');
        const onlyImgTimeInput = document.getElementById('only-img-time');
        const textTimeInput = document.getElementById('text-time');
        const gapTimeInput = document.getElementById('gap-time');
        const noteInput = document.getElementById('note-select');
        const colorPicker = document.getElementById("color-picker");
        const overlay = document.getElementById('overlay');

        // Load values from local storage
        let onlyImgTime = parseInt(localStorage.getItem('onlyImgTime')) || 7;
        let textTime = parseInt(localStorage.getItem('textTime')) || 3;
        let gapTime = parseInt(localStorage.getItem('gapTime')) || 0;
        let note = localStorage.getItem('note');
        if (note) {
            note = note.toLowerCase().replace(/#/g, 'sharp');
        } else {
            note = 'free';
        }
        let savedColor = localStorage.getItem("savedColor");
        if (savedColor) {
            colorPicker.value = savedColor;
            document.documentElement.style.setProperty("--main-color", savedColor);
        } else {
            document.documentElement.style.setProperty("--main-color", '000000');
        }

        // Update input values
        onlyImgTimeInput.value = onlyImgTime;
        textTimeInput.value = textTime;
        gapTimeInput.value = gapTime;
        noteInput.value = note.replace(/sharp/g, '#').toUpperCase();
        colorPicker.value = savedColor;

        // Show/hide settings container and overlay
        settingsButton.addEventListener('click', () => {
            settingsContainer.classList.toggle("show");
            overlay.classList.toggle("show");
        });
        overlay.addEventListener('click', () => {
            settingsContainer.classList.remove("show");
            overlay.classList.remove("show");
        });

        // Handle update button click event
        updateButton.addEventListener('click', () => {
            // Check if input values are valid
            if (onlyImgTimeInput.value < 1 || textTimeInput.value < 1) {
                alert("Please enter valid values. Chord diagram and name diaplay time cannot be lesser than 1.");
                return;
            }
            if (gapTimeInput.value < 0) {
                alert("Please enter valid values. Gap time cannot be lesser than 0.");
                return;
            }
            // Update variable values and store in local storage
            onlyImgTime = parseInt(onlyImgTimeInput.value);
            textTime = parseInt(textTimeInput.value);
            gapTime = parseInt(gapTimeInput.value);
            note = noteInput.value.toLowerCase().replace(/#/g, 'sharp');
            savedColor = colorPicker.value;
            localStorage.setItem('onlyImgTime', onlyImgTime);
            localStorage.setItem('textTime', textTime);
            localStorage.setItem('gapTime', gapTime);
            localStorage.setItem('note', note);
            localStorage.setItem('savedColor', savedColor);
            location.reload();
        });

        // Add an event listener to the "Reset" button
        defaultButton.addEventListener('click', () => {
            // Set the default values for the variables
            onlyImgTime = 7;
            textTime = 3;
            gapTime = 0;
            note = 'FREE';
            savedColor = '000000';

            // Store the default values in local storage
            localStorage.setItem('onlyImgTime', onlyImgTime);
            localStorage.setItem('textTime', textTime);
            localStorage.setItem('gapTime', gapTime);
            localStorage.setItem('note', note);
            localStorage.setItem('savedColor', savedColor);

            // Update the input values
            onlyImgTimeInput.value = onlyImgTime;
            textTimeInput.value = textTime;
            gapTimeInput.value = gapTime;
            noteInput.value = note;
            colorPicker.value = savedColor;
            location.reload();
        });

        // Add event listener for when color picker value changes
        colorPicker.addEventListener("change", function () {
            // Get selected color value and store in local storage
            const savedColor = colorPicker.value;
            localStorage.setItem("savedColor", savedColor);

            // Set CSS variable to selected color value
            document.documentElement.style.setProperty("--main-color", savedColor);
        });

        // Handle cancel button click event
        cancelButton.addEventListener('click', () => {
            settingsContainer.classList.remove("show");
            overlay.classList.remove("show");
        });

        // Display a random image and name pair
        function displayRandomImage() {
            const randomIndex = Math.floor(Math.random() * images[note].length);
            imageElement.src = images[note][randomIndex];

            // Show the image alone
            imageElement.style.display = "block";
            imageElement.style.borderRadius = "12px";
            setTimeout(() => {
                // Show the name with the image still displaying
                imageElement.style.borderRadius = "12px 12px 0 0";
                nameElement.style.display = "block";
                nameElement.textContent = names[note][randomIndex];

                // Hide the name and image to repeat
                setTimeout(() => {
                    nameElement.style.display = "none";
                    imageElement.style.display = "none";

                    // Display the new set after hiding the previous one
                    setTimeout(() => {
                        displayRandomImage();
                    }, gapTime * 1000);
                }, textTime * 1000);
            }, onlyImgTime * 1000);
        }

        // Display the first image and hide the name initially
        displayRandomImage();
        nameElement.style.display = "none";
    </script>
</body>

</html>
